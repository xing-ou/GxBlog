<!doctype html>
<html class="docs-version-current" lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Gx&#39;sBlog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Gx&#39;sBlog Atom Feed"><title data-react-helmet="true">探索断点改进 | Gx&#x27;sBlog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://gouxin.fun/docs/wwdc/开发者工具/wwdc21/探索断点改进"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="探索断点改进 | Gx&#x27;sBlog"><meta data-react-helmet="true" name="description" content="xcode13中断点新增功能，比如列断点"><meta data-react-helmet="true" property="og:description" content="xcode13中断点新增功能，比如列断点"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://gouxin.fun/docs/wwdc/开发者工具/wwdc21/探索断点改进"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/docs/wwdc/开发者工具/wwdc21/探索断点改进" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/docs/wwdc/开发者工具/wwdc21/探索断点改进" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.46031542.css">
<link rel="preload" href="/assets/js/runtime~main.a5420036.js" as="script">
<link rel="preload" href="/assets/js/main.5da52804.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">我的Blog</b></a><a class="navbar__item navbar__link" href="/">近期文章</a><a class="navbar__item navbar__link" href="/archive">日期归档</a><a class="navbar__item navbar__link" href="/tags">所有标签</a><a class="navbar__item navbar__link" href="/reading">书籍阅读</a><a class="navbar__item navbar__link" href="/aboutme">关于我</a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/wwdc/关于本专题">关于本专题</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/wwdc/开发者工具/wwdc21/使用DocC构建交互教程">开发者工具</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/使用DocC构建交互教程">wwdc21</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/使用DocC构建交互教程">使用DocC构建交互教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/使用静态分析器及早发现错误">使用静态分析器及早发现错误</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/托管和自动化DocC文档">托管和自动化DocC文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/探索断点改进">探索断点改进</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/接受XCTest中的预期失败">接受XCTest中的预期失败</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/提升Xcode中DocC文档质量">提升Xcode中DocC文档质量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/认识xcode中的DocC文档">认识xcode中的DocC文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/wwdc/开发者工具/wwdc21/通过测试重复来诊断不可靠的代码">通过测试重复来诊断不可靠的代码</a></li></ul></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>探索断点改进</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="列断点">列断点<a aria-hidden="true" class="hash-link" href="#列断点" title="Direct link to heading">​</a></h2><p>我们在设置断点的时候，通常都是在某行的开头打上断点标记。但是随着swift的发展，尾随闭包、计算属性、$0这种默认参数名称等等，让我们可以在一行中很简洁的表达意图。但是，我们在这一行打上断点的时候，编译器会为我们生成多个可供lldb中断的位置。举个例子:</p><div class="codeBlockContainer_K1bP language-swift"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class ViewController: UIViewController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var ajustDensity: Bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func convertedToVolume(ajustDensity: Bool) -&gt; Int {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ajustDensity ? 100 : 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    override func viewDidLoad() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.viewDidLoad()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 在下面这一行打上断点，step会进入到计算属性ajustDensity中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let result = self.convertedToVolume(ajustDensity: self.ajustDensity)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(result)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p>xcode13提供了更精细的断点控制：<code>列断点</code>。比如上面的代码，我们只想在<code>convertedToVolume</code>方法上打断点，不想进入<code>ajustDensity</code>计算属性中。</p><p>此时可以移到对应函数上，鼠标右键单击，选择<code>create column breakpoint</code>。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwja990g2jj30sq07qwfd.jpg" alt="image-20211118142344368"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjaa0xs44j30p009qjs9.jpg" alt="image-20211118142435653"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjacvkn57j30su07a3zd.jpg" alt="image-20211118142719632"></p><p>打上列断点后就会出现一个小箭头，我们单击小箭头就能出现断点设置相关界面，可以编辑、移除。</p><p>同时，当进入断点时，对应位置会用<code>绿色的下划线</code>进行标记，表明当前断点的位置。</p><p>再来看个swift闭包的例子:</p><div class="codeBlockContainer_K1bP language-swift"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">let array = [1,2,3,4,5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">let result = array.map{ &quot;\($0)&quot; }.map{ &quot;\($0)\($0)&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(result)</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p>我们只想在第二个map中打下断点，查看$0的值，所以我们可以在第二个map中的$0上打上列断点。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="符号断点">符号断点<a aria-hidden="true" class="hash-link" href="#符号断点" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_K1bP language-swift"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class ViewController: UIViewController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func toggle() -&gt; Bool {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    override func viewDidLoad() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        super.viewDidLoad()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Do any additional setup after loading the view.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var a = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        a.toggle()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let result = self.toggle()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        print(result)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p>我们添加一个symble包含<code>toggle</code>的<code>Symbolic Breakpoint</code>。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjasb7crlj30pi0e4dh9.jpg" alt="image-20211118144209630"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjatp2re7j30nq07it9n.jpg" alt="image-20211118144329733"></p><p>他会匹配系统库在内的所有符合的符号。如果没有限制，可能会命中非常多的位置。还好我们可以将搜索结果限制在某个module中。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjazkf0k7j30ny0cowfi.jpg" alt="image-20211118144907506"></p><p>现在就只有viewcontroller中的toggle会进入断点。</p><p>如果我们创建了一个找不到的<code>symblic breakpoint</code>，xcode会显示一个<code>虚线断点</code>。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjb5ffn4hj30oi05qwep.jpg" alt="image-20211118145446536"></p><p>这是xcode13的新功能，如果某个断点没有被lldb解析出是在哪个位置，就会显示一个虚线断点。虚线断点出现的原因可能有无数个，不过我们都可以鼠标悬停在虚线断点上面，xcode会显示一个原因弹窗。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjbcgeku9j305k034q2t.jpg" alt="IMG_3736"></p><p>上面显示了可能原因:</p><ul><li>检测拼写错误</li><li>符号是否存在</li><li>Library是否loaded</li></ul><p>我们也可以在lldb中去搜索符号:</p><div class="codeBlockContainer_K1bP language-shell"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lldb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> image lookup -rn toggle SwiftDemo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> match found </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> /Users/gx/Library/Developer/Xcode/DerivedData/SwiftDemo-bjjbgmlihoaimlfphiakxpgactle/Build/Products/Debug-iphonesimulator/SwiftDemo.app/SwiftDemo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Address: SwiftDemo</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">0x0000000100002e50</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SwiftDemo.__TEXT.__text + </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Summary: SwiftDemo`SwiftDemo.ViewController.toggle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Swift.Bool at ViewController.swift:12</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p><code>虚线断点</code>还有可能出现在<code>source file breakpoint </code>中。同样的我们悬停在上面，可以看到通常的原因：</p><ul><li>这一行没被编译，比如：<code>#if</code>限制等</li><li>Build setting中是否设置了生成调试信息</li><li>。。。</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="runtime-issues-breakpoint">Runtime Issues Breakpoint<a aria-hidden="true" class="hash-link" href="#runtime-issues-breakpoint" title="Direct link to heading">​</a></h2><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjbqpbmnoj30v20bqdgx.jpg" alt="image-20211118151512417"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjbr1yx2yj30hy0703yk.jpg" alt="image-20211118151533675"></p><p>这会在我们遇到Runtime问题时进入断点。注意后面的描述<code>to hit the breakpoint ...</code>，我们还需要进入diagnostic中进行设置，我们可以点那个小箭头快速进入设置界面。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwjbtt0f4bj30ps0aqjs1.jpg" alt="image-20211118151811176"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/docs/tags/wwdc">wwdc</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/docs/tags/lldb">lldb</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/docs/tags/breakpoint">breakpoint</a></li></ul></div></div><section></section></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/wwdc/开发者工具/wwdc21/托管和自动化DocC文档"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">« <!-- -->托管和自动化DocC文档</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/wwdc/开发者工具/wwdc21/接受XCTest中的预期失败"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">接受XCTest中的预期失败<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#列断点" class="table-of-contents__link toc-highlight">列断点</a></li><li><a href="#符号断点" class="table-of-contents__link toc-highlight">符号断点</a></li><li><a href="#runtime-issues-breakpoint" class="table-of-contents__link toc-highlight">Runtime Issues Breakpoint</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.a5420036.js"></script>
<script src="/assets/js/main.5da52804.js"></script>
</body>
</html>
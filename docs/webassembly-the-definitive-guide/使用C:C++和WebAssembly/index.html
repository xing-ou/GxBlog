<!doctype html>
<html class="docs-version-current" lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Gx&#39;sBlog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Gx&#39;sBlog Atom Feed"><title data-react-helmet="true">ç¬¬äº”ç« ã€ä½¿ç”¨C/C++å’ŒWebAssembly | Gx&#x27;sBlog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://gouxin.fun/docs/webassembly-the-definitive-guide/ä½¿ç”¨C:C++å’ŒWebAssembly"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="ç¬¬äº”ç« ã€ä½¿ç”¨C/C++å’ŒWebAssembly | Gx&#x27;sBlog"><meta data-react-helmet="true" name="description" content="C/C++å’ŒWebAssemblyæ˜¯å¦‚ä½•ä¸€èµ·å·¥ä½œçš„"><meta data-react-helmet="true" property="og:description" content="C/C++å’ŒWebAssemblyæ˜¯å¦‚ä½•ä¸€èµ·å·¥ä½œçš„"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://gouxin.fun/docs/webassembly-the-definitive-guide/ä½¿ç”¨C:C++å’ŒWebAssembly"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/docs/webassembly-the-definitive-guide/ä½¿ç”¨C:C++å’ŒWebAssembly" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/docs/webassembly-the-definitive-guide/ä½¿ç”¨C:C++å’ŒWebAssembly" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0efb2d18.css">
<link rel="preload" href="/assets/js/runtime~main.fa8e739b.js" as="script">
<link rel="preload" href="/assets/js/main.82f7dc91.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">æˆ‘çš„Blog</b></a><a class="navbar__item navbar__link" href="/">è¿‘æœŸæ–‡ç« </a><a class="navbar__item navbar__link" href="/archive">æ—¥æœŸå½’æ¡£</a><a class="navbar__item navbar__link" href="/tags">æ‰€æœ‰æ ‡ç­¾</a><a class="navbar__item navbar__link" href="/reading">ä¹¦ç±é˜…è¯»</a><a class="navbar__item navbar__link" href="/aboutme">å…³äºæˆ‘</a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly-the-definitive-guide/å…³äºæœ¬ä¹¦">å…³äºæœ¬ä¹¦</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly-the-definitive-guide/ç®€ä»‹">ç¬¬ä¸€ç« ã€ç®€ä»‹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly-the-definitive-guide/hello-world">ç¬¬äºŒç« ã€hello world</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webassembly-the-definitive-guide/WebAssembly-Module">ç¬¬ä¸‰ç« ã€WebAssembly Module</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/webassembly-the-definitive-guide/ä½¿ç”¨C:C++å’ŒWebAssembly">ç¬¬äº”ç« ã€ä½¿ç”¨C/C++å’ŒWebAssembly</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ç¬¬äº”ç« ã€ä½¿ç”¨C/C++å’ŒWebAssembly</h1></header><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´è®¨è®ºçš„æ˜¯WebAssembly åŠå…¶ç›´ç›¸å…³å·¥å…·å’ŒæŠ€æœ¯ï¼Œè¿™äº›ä¸œè¥¿å¯¹äºæ¢ç´¢webassemblyæä¾›çš„åŠŸèƒ½æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯å¦‚æœè¦ç”¨è¿™äº›å¼€å‘æ–°è½¯ä»¶ï¼Œé‚£å°±å°±æ˜¾å¾—ä½æ•ˆäº†ã€‚é•¿æœŸä»¥æ¥ï¼Œé«˜çº§ç¼–ç¨‹è¯­è¨€ä½¿æˆ‘ä»¬èƒ½ä¸ç”¨å…³æ³¨ä½çº§æŒ‡ä»¤çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´ç®€å•ã€é«˜æ•ˆçš„ã€è¯­æ„ä¸°å¯Œçš„è¡¨è¾¾å¼æ¥è¡¨ç¤ºæˆ‘ä»¬çš„é€»è¾‘ã€‚</p><p>ä¸ºäº†çœŸæ­£ç†è§£ WebAssembly æä¾›çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åº”è¯¥äº†è§£ä¼—å¤šèƒ½å¤Ÿç¼–è¯‘æˆwebassemblyçš„è¯­è¨€ä¸­çš„ä¸€ç§ã€‚</p><p>å¹¶ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½é€‚åˆç”¨JavaScriptè§£å†³ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…¶ä»–è¯­è¨€æ¥æé«˜æ€§èƒ½ã€æé«˜è¡¨è¾¾çš„æ¸…æ™°åº¦æˆ–è€…é‡ç”¨ç°æœ‰ä»£ç ã€‚</p><p>C è¯­è¨€æ˜¯ä¸–ç•Œä¸Šæœ€é‡è¦å’Œæœ€å¹¿æ³›ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€ã€‚C ä¸­æœ‰å¤§é‡å¯ç”¨çš„è½¯ä»¶ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†å¯ä»¥ç®€å•åœ°é‡æ–°ç¼–è¯‘ä¸º WebAssemblyã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 6 ç« è®¨è®ºç§»æ¤ç°æœ‰åº“ï¼Œä½†ç°åœ¨æˆ‘ä»¬å°†å­¦ä¹ ä¸€ç‚¹ C ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒæ¥æ”¹è¿›æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢å°è¯•è¿‡çš„ä¸€äº›å·¥ä½œã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="ä½¿ç”¨-c-å‡½æ•°">ä½¿ç”¨ C å‡½æ•°<a aria-hidden="true" class="hash-link" href="#ä½¿ç”¨-c-å‡½æ•°" title="Direct link to heading">â€‹</a></h2><p>C å‡½æ•°åœ¨å¾ˆå¤šæ–¹é¢éƒ½ç±»ä¼¼äº JavaScript å‡½æ•°ã€‚å®ƒå¯èƒ½å¸¦å‚æ•°ï¼Œä¹Ÿå¯èƒ½ä¸å¸¦å‚æ•°ã€‚å®ƒåªèƒ½è¿”å›ä¸€ä¸ªå€¼å¹¶ä¸”ä¸æ”¯æŒå¼‚å¸¸ï¼Œå› æ­¤é”™è¯¯å¤„ç†é€šå¸¸æ¯”åœ¨ C++ã€Java æˆ– JavaScript ä¸­æ›´åŸå§‹ä¸€äº›ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹å¹´é¾„è®¡ç®—å‡½æ•°çš„ C å®ç°ï¼š</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-1ã€‚ä¸€ä¸ªç®€å•çš„ C ç¨‹åºã€‚</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">howOld</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> currentYear</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> yearBorn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">yearBorn </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> currentYear</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> currentYear </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> yearBorn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> age </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">howOld</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2021</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">age </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;You are %d!\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> age</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;You haven&#x27;t been born yet.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¸å¹¸çš„æ˜¯ï¼Œè®¡ç®—æœºä¸ç†è§£è¿™äº›é«˜çº§è¯­è¨€ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†å®ƒä»¬è½¬æ¢ä¸ºäºŒè¿›åˆ¶æœºå™¨ç ä»¥ä¾›æ‰§è¡Œã€‚å¦‚æœä½ åªåšè¿‡ JavaScript ç¼–ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½æœ‰ç‚¹é™Œç”Ÿã€‚ä½œä¸ºä¸€ç§è§£é‡Šæ€§è¯­è¨€ï¼Œæ‚¨ç¼–å†™ JavaScript å¹¶ç®€å•åœ°è¿è¡Œå®ƒã€‚ä¸œè¥¿éƒ½æ˜¯æœ‰åˆ©æœ‰å¼Šçš„ï¼Œå¯¹å¼€å‘äººå‘˜æ¥è¯´æ–¹ä¾¿çš„ï¼Œé€šå¸¸åœ¨è¿è¡Œæ—¶ä¼šæ˜æ˜¾å˜æ…¢ï¼Œè€Œ C å’Œ C++ é•¿æœŸä»¥æ¥ä¸€ç›´ä»¥æ€§èƒ½è‘—ç§°ã€‚</p><p>æˆ‘ä»¬ç¼–è¯‘howold.cä¸ºå¯æ‰§è¡Œæ–‡ä»¶:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang howold.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -laF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">112</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> brian  staff    </span><span class="token number" style="color:#36acaa">128</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:35 ./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> brian  staff    </span><span class="token number" style="color:#36acaa">192</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:32 </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff  </span><span class="token number" style="color:#36acaa">49456</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:35 a.out*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff    </span><span class="token number" style="color:#36acaa">343</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:36 howold.c</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç”±äºå†å²åŸå› ï¼Œç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ç§°ä¸º <em>a.out</em>ã€‚ç¨åæ‚¨å°†çœ‹åˆ°å¦‚ä½•æ›´æ”¹å®ƒã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œç¨‹åºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./a.out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You are </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æˆ‘ä»¬è®¨è®º clang ä½œä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹ C ç¼–è¯‘å™¨çš„ä¸»è¦åŸå› æ˜¯å› ä¸ºå®ƒå…·æœ‰åŸºäº LLVM é¡¹ç›®çš„ç°ä»£ã€å¯æ’æ‹”æ¶æ„ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸ªç”±ä¸‰éƒ¨åˆ†ç»„æˆçš„è¿‡ç¨‹ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gw858xzgtuj30ze0diwf5.jpg" alt="image-20211108230917850"></p><p>æºç ç»ç”±<code>Parser</code>å˜æˆä¸€ä¸ªä¸­é—´è¡¨ç¤º(IR)ï¼ŒIRæ˜¯ä¸€ç§å‡çš„æŒ‡ä»¤é›†ã€‚ä½¿ç”¨IRè¡¨è¾¾é€»è¾‘ï¼Œäº¤ç»™<code>Optimizer</code>å¤„ç†ã€‚ä¼˜åŒ–è¿‡ç¨‹æ¶‰åŠä¸€ä¸ªæˆ–å¤šä¸ªè½¬æ¢ï¼Œè¿™äº›è½¬æ¢èƒ½å¤Ÿæ ¹æ®IRè¡¨è¾¾çš„é€»è¾‘ä½¿ä»£ç æ›´å¿«æˆ–æ›´é«˜æ•ˆï¼Œæ¯”å¦‚ï¼šå¾ªç¯å±•å¼€ã€æ— ç”¨ä»£ç åˆ é™¤ã€å¸¸é‡è¡¨è¾¾å¼çš„è®¡ç®—ç­‰ç­‰ã€‚æœ€åäº¤ç»™<code>backend</code>ç”Ÿæˆç‰¹å®šå¹³å°çš„æœºå™¨ç ã€‚</p><p>è¿™äº›å±‚ä¸­çš„ä»»ä½•ä¸€å±‚éƒ½å¯ä»¥æ¢æˆå…¶ä»–ä¸œè¥¿ã€‚æ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼ŒRustã€Julia å’Œ Swift ç­‰è¯­è¨€ä½¿ç”¨ LLVM åŸºç¡€æ¶æ„ã€‚è¿™ä½¿è¯­è¨€ä½œè€…ä¸å¿…æ¯æ¬¡éƒ½ä»å¤´å¼€å§‹ã€‚ä»–ä»¬åªç”¨ç¼–å†™æ–°çš„å‰ç«¯è§£æå™¨ï¼Œç„¶ååˆ©ç”¨å¤§éƒ¨åˆ†ç°æœ‰çš„<code>Optimizer</code>å’Œ<code>backend</code>ã€‚ç¼–è¯‘å™¨ç ”ç©¶äººå‘˜å¯ä»¥å¼€å‘æ–°çš„ä¼˜åŒ–å¹¶å•ç‹¬æµ‹è¯•å®ƒä»¬ï¼Œç„¶åå†å°†å®ƒä»¬ç”¨äºä»»æ„è¾“å…¥è¯­è¨€çš„ IRã€‚å¯¹äºæˆ‘ä»¬æ¥è¯´ï¼Œ<code>Backend</code>æ˜¯æœ€é‡è¦çš„å¯äº¤æ¢å±‚ã€‚åœ¨ Linux æˆ– Windows ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ç›¸åŒçš„å‰ä¸¤å±‚çš„æœ¬æœºç‰ˆæœ¬ï¼Œä½†éƒ½ä¼šæœ‰ä¸€ä¸ªç‰¹å®šäºå¹³å°çš„<code>Backend</code>ã€‚</p><p>æ‚¨é€šå¸¸é€šè¿‡ç§°ä¸ºäº¤å‰ç¼–è¯‘çš„è¿‡ç¨‹ï¼Œæ¥ç”Ÿæˆä¸è®¡ç®—æœºæœ¬æœºè¿è¡Œæ—¶ä¸åŒçš„åç«¯ã€‚è¿™å¯¹äºé’ˆå¯¹å¯èƒ½æœªå®‰è£…å¼€å‘äººå‘˜å·¥å…·é“¾çš„åµŒå…¥å¼ç³»ç»Ÿå¾ˆæœ‰ç”¨ã€‚è¿™åœ¨æŒç»­é›†æˆå’Œäº¤ä»˜ç³»ç»Ÿä¸­ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œæ‚¨å¯ä»¥ä»åŒä¸€æ„å»ºç¯å¢ƒä¸­æŒ‡å®šå¤šä¸ªå¹³å°ï¼Œå¦åˆ™ï¼Œæ‚¨å¯èƒ½éœ€è¦ä¸ºæ¯ä¸ªç›®æ ‡å¹³å°æä¾›ä¸€ä¸ªå•ç‹¬çš„æ„å»ºç¯å¢ƒã€‚</p><p>Emscripten å·¥å…·é“¾æ˜¯ä¸º asm.js å·¥ä½œè€Œå¼€å‘çš„ï¼Œå®ƒåŸºäº LLVM å’Œ clangï¼Œå› æ­¤å®ƒåªéœ€è¦è¾“å‡º JavaScript çš„å¯ä¼˜åŒ–å­é›†ï¼Œå³å¯å…è®¸ C ç¨‹åºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚å½“ WebAssembly æŒ‡ä»¤é›†å’Œè¿è¡Œå¹³å°ç¡®å®šåï¼Œæœ¬è´¨ä¸Šï¼Œä»–ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ª WebAssembly åç«¯å°±è¡Œäº†ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« ä»‹ç»è¿™ä¸ªå·¥å…·é“¾ï¼Œä½†å¸Œæœ›æ‚¨èƒ½äº†è§£å¦‚ä½•å°†é«˜çº§è¯­è¨€ç¼–è¯‘ä¸ºé€šç”¨å½¢å¼ï¼Œç„¶åè¿›ä¸€æ­¥è½¬æ¢ä¸ºæœ‰æ•ˆçš„æœ¬åœ°è¡¨ç¤ºã€‚</p><p>æˆ‘ä»¬å®‰è£…çš„ LLVM åº”è¯¥åŸç”Ÿæ”¯æŒ WebAssembly ä½œä¸ºåç«¯ã€‚è¦æŸ¥çœ‹çš„è¯ï¼Œè¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> llc --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LLVM </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">http://llvm.org/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  LLVM version </span><span class="token number" style="color:#36acaa">11.0</span><span class="token plain">.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Optimized build.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Default target: x86_64-apple-darwin20.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Host CPU: skylake</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Registered Targets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aarch64    - AArch64 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">little endian</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aarch64_32 - AArch64 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">little endian ILP32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aarch64_be - AArch64 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">big endian</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arm        - ARM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arm64      - ARM64 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">little endian</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arm64_32   - ARM64 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">little endian ILP32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nvptx      - NVIDIA PTX </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    nvptx64    - NVIDIA PTX </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppc32      - PowerPC </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppc64      - PowerPC </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ppc64le    - PowerPC </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> LE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    r600       - AMD GPUs HD2XXX-HD6XXX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    riscv32    - </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">-bit RISC-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    riscv64    - </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-bit RISC-V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wasm32     - WebAssembly </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wasm64     - WebAssembly </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x86        - </span><span class="token number" style="color:#36acaa">32</span><span class="token plain">-bit X86: Pentium-Pro and above</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x86-64     - </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">-bit X86: EM64T and AMD64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xcore      - XCore</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ä¸ºäº†ç®€åŒ–ä½¿ç”¨ï¼Œæˆ‘ä»¬å»æ‰mainå‡½æ•°ï¼Œåªä¿ç•™<code>howoldå‡½æ•°</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">howOld</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> currentYear</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> yearBorn</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">yearBorn </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> currentYear</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> currentYear </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> yearBorn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç„¶åå°†å…¶ç¼–è¯‘ä¸ºwebassembly:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang --target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">wasm32 -nostdlib -Wl,--no-entry </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-Wl,--export-all howold2.c -o howold.wasm</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><code>--target=wasm32</code>æŒ‡ä»¤æŒ‡å®šè¾“å‡ºä¸º 32 ä½ WebAssembly å¹³å°ã€‚<code>-nostdlib</code>å‘Šè¯‰å®ƒä¸éœ€è¦é“¾æ¥æ ‡å‡†åº“ã€‚<code>--no-entry</code>å’Œ<code>--export-all</code>æŒ‡ä»¤å‘Šè¯‰é“¾æ¥å™¨ï¼Œæˆ‘ä»¬æ²¡æœ‰<code>main()</code>å‡½æ•°ï¼Œå¹¶ä¿ç•™æ‰€æœ‰çš„å‡½æ•°ç”¨äºexportã€‚å¦‚æœæ²¡æœ‰åè€…ï¼Œä¼˜åŒ–è¿‡ç¨‹å¯èƒ½ä¼šç§»é™¤æœªä½¿ç”¨çš„å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰è°ƒç”¨å®ƒã€‚<code>-o howold.wasm</code>æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨wasm-objdumpæŸ¥çœ‹ä¸€ä¸‹è¾“å‡º:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> wasm-objdump -x howold.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">howold.wasm:    </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">format</span><span class="token plain"> wasm 0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Section Details:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - type</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - type</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i32, i32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> i32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Function</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">sig</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__wasm_call_ctors</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">sig</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">howOld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Memory</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - memory</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> pages: </span><span class="token assign-left variable" style="color:#36acaa">initial</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__stack_pointer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">66560</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__dso_handle</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__data_end</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__global_base</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__heap_base</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">66560</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__memory_base</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> i32 </span><span class="token assign-left variable" style="color:#36acaa">mutable</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__table_base</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> - init </span><span class="token assign-left variable" style="color:#36acaa">i32</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - memory</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;memory&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__wasm_call_ctors</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__wasm_call_ctors&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">howOld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;howOld&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__dso_handle&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__data_end&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__global_base&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__heap_base&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__memory_base&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__table_base&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Code</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__wasm_call_ctors</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">134</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">howOld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Custom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - name: </span><span class="token string" style="color:#e3116c">&quot;name&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__wasm_call_ctors</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">howOld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - global</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">__stack_pointer</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Custom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - name: </span><span class="token string" style="color:#e3116c">&quot;producers&quot;</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¥½äº†ï¼Œæˆ‘ä»¬å†™ä¸ªhtmlæ¥ä½¿ç”¨å®ƒ:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">html</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">lang</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">en</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">charset</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">UTF-8</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">http-equiv</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">X-UA-Compatible</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">IE=edge</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">viewport</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">width=device-width, initial-scale=1.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">title</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Document</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">title</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">head</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">container</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag style-attr attr-name" style="color:#00a4db">style</span><span class="token tag style-attr attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag style-attr attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag style-attr attr-value style language-css property" style="color:#36acaa">width</span><span class="token tag style-attr attr-value style language-css punctuation" style="color:#393A34">:</span><span class="token tag style-attr attr-value style language-css" style="color:#e3116c"> </span><span class="token tag style-attr attr-value style language-css number" style="color:#36acaa">80</span><span class="token tag style-attr attr-value style language-css unit" style="color:#e3116c">%</span><span class="token tag style-attr attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">How Old Are You?</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">label</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">for</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">year</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">yearborn</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-label</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Year Born</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">label</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">range</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-range</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">year</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">year</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">form-label</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">You are: </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">span</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">age</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">span</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">fetchAndInstantiate</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">url</span><span class="token script language-javascript parameter punctuation" style="color:#393A34">,</span><span class="token script language-javascript parameter"> importObject</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">url</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">response</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> response</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">arrayBuffer</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">bytes</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript known-class-name class-name">WebAssembly</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">instantiate</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">bytes</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> importObject</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          </span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">result</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript arrow operator" style="color:#393A34">=&gt;</span><span class="token script language-javascript"> result</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> d </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">Date</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> currentYear </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> d</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getFullYear</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> slider </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getElementById</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;year&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> yearBorn </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getElementById</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;yearborn&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> ageSpan </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">getElementById</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;age&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript function" style="color:#d73a49">fetchAndInstantiate</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;howold.wasm&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">setAttribute</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;min&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> currentYear </span><span class="token script language-javascript operator" style="color:#393A34">-</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">100</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">setAttribute</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;max&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> currentYear</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> </span><span class="token script language-javascript function-variable function" style="color:#d73a49">updateLabels</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">val</span><span class="token script language-javascript parameter punctuation" style="color:#393A34">,</span><span class="token script language-javascript parameter"> age</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          yearBorn</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">innerText</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;Year Born: &quot;</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript"> val</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          ageSpan</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">innerText</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> age</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> </span><span class="token script language-javascript function-variable function" style="color:#d73a49">listener</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> age </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">howOld</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">currentYear</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">value</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">          </span><span class="token script language-javascript function" style="color:#d73a49">updateLabels</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">value</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> age</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">onchange</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> listener</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">oninput</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> listener</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        slider</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">value</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript string" style="color:#e3116c">&quot;1972&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">        </span><span class="token script language-javascript function" style="color:#d73a49">updateLabels</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">1972</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">49</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="äº‹æƒ…å˜å¾—å¤æ‚">äº‹æƒ…å˜å¾—å¤æ‚<a aria-hidden="true" class="hash-link" href="#äº‹æƒ…å˜å¾—å¤æ‚" title="Direct link to heading">â€‹</a></h2><p>æˆ‘å·²ç»å‘æ‚¨å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹å°†å‡ ä¸ªæ•°å­—ä¼ é€’ç»™ä¸€ä¸ªåªè¿”å›ä¸€ä¸ªæ•°å­—çš„å‡½æ•°ã€‚è¿™ä¸æˆ‘ä»¬è¿„ä»Šä¸ºæ­¢æ‰€åšçš„æ²¡æœ‰æœ¬è´¨ä¸Šçš„ä¸åŒã€‚</p><p>æ›´å¤æ‚çš„ C ç¨‹åºå°†éš¾ä»¥å¦‚æ­¤ç®€å•åœ°æ˜ å°„åˆ°æ‚¨æ‰€æ¥è§¦çš„å¹³å°ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬çš„â€œHello, World!â€ä¸­<code>printf()</code>å‡½æ•°å°±æ˜¯æµè§ˆå™¨æ²¡æœ‰çš„åŠŸèƒ½ã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ C ç¨‹åºçš„å†…å­˜æ˜¯å¦‚ä½•åˆ†é…å’Œæ¸…ç†çš„ã€‚åœ¨æˆ‘ä»¬æ­£åœ¨æ¢ç´¢çš„è¿™ä¸ªä¸–ç•Œä¸­ï¼Œå°†å„ç§ç¼–è¯‘çš„æ–‡ä»¶é“¾æ¥åœ¨ä¸€èµ·çš„è¿‡ç¨‹ä¹Ÿæœ‰ç€æ ¹æœ¬çš„ä¸åŒã€‚</p><p>å¥½æ¶ˆæ¯æ˜¯ï¼Œè¿™äº›é—®é¢˜ä¸­çš„å¤§éƒ¨åˆ†éƒ½å¯ä»¥é€šè¿‡å·¥å…·å’Œè¿è¡Œæ—¶å¹³å°æ¥å¤„ç†ã€‚åæ¶ˆæ¯æ˜¯ç»†èŠ‚å¾ˆå¿«å˜å¾—ç›¸å½“å¤æ‚ã€‚å¦‚æœæ‚¨ä¹‹å‰ä»æœªæ¥è§¦è¿‡ä»»ä½• C ç¼–ç¨‹ï¼Œè¿™é‡Œé¢å°†ä¼šæœ‰è®¸å¤šæ–°çš„æ¦‚å¿µã€‚è¿™æœ¬ä¹¦ä¸èƒ½æ•™ä½ æ‰€æœ‰çš„ä¸œè¥¿ï¼Œä½†æˆ‘ä¼šå°½é‡å¼ºè°ƒè¿™ç§è¯­è¨€å’Œ WebAssemblyä¹‹é—´çš„ç‰¹å®šäº¤äº’ã€‚</p><p>æƒ³è±¡ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œå®ƒä¸å¸¦å‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ•°ç»„çš„æ€»å’Œã€‚<code>ä¾‹ 5-5</code>å°±æ˜¯è¿™æ ·ä¸€ä¸ªä¾‹å­ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰å‚æ•°ï¼Œç¼–è¯‘å™¨å¯ä»¥çŸ¥é“æ•°ç»„éœ€è¦å¤šå¤§å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨åä¸ªæ•°å­—å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-5ã€‚ä¸€ä¸ªç®€å•çš„ C å‡½æ•°</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retValue </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦‚æœæˆ‘ä»¬å°è¯•ç¼–è¯‘è¿™ä¸ªç¨‹åºï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°è­¦å‘Šï¼Œå› ä¸º clang æœŸæœ›æœ‰ä¸€ä¸ª<code>main()</code>å‡½æ•°ã€‚å› ä¸ºå®ƒæ‰¾ä¸åˆ°å…·æœ‰æ­¤åç§°çš„æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒæ— æ³•å°†æ‰€æœ‰å†…å®¹é“¾æ¥åˆ°ç‹¬ç«‹è¿è¡Œæ—¶ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang simple.c -o simple.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Undefined symbols </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> architecture x86_64:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;_main&quot;</span><span class="token plain">, referenced from:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     implicit entry/start </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> main executable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ld: symbol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> not found </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> architecture x86_64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clang-11: error: linker </span><span class="token builtin class-name">command</span><span class="token plain"> failed with </span><span class="token builtin class-name">exit</span><span class="token plain"> code </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">use -v to see invocation</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>åˆ«æ‹…å¿ƒï¼Œå¾ˆå®¹æ˜“è§£å†³ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å‘Šè¯‰ clangåªæ˜¯ç¼–è¯‘ä»£ç ï¼Œä½†ä¸å°†å…¶ä¸<code>-c</code>é€‰é¡¹é“¾æ¥ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang -c simple.c -o simple.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -laF simple.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff   </span><span class="token number" style="color:#36acaa">170</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:27 simple.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff  </span><span class="token number" style="color:#36acaa">1060</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:43 simple.o</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™ç”Ÿæˆäº†ä¸€ä¸ª.oæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å®šä¹‰ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>nm</code> å‘½ä»¤æŸ¥çœ‹:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> nm -a simple.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U ___stack_chk_fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U ___stack_chk_guard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 T _addArray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U _memcpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00000000000000a0 s l___const.addArray.array</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>èµ·åˆè¿™çœ‹èµ·æ¥å¯èƒ½ä¼šä»¤äººå›°æƒ‘ï¼Œä¸è¿‡è§£é‡Šä¸‹åä½ å°±èƒ½æ˜ç™½ã€‚æˆ‘ä»¬çš„å‡½æ•°ï¼Œ<code>addArray()</code>è¢«å®šä¹‰ä¸ºç›®æ ‡æ–‡ä»¶ä¸­çš„æ–‡æœ¬æ®µç¬¦å·ã€‚å¸¦æœ‰<code>U</code>ç¬¦å·ç±»å‹çš„ä¸‰ä¸ªé¡¹ç›®è¡¨ç¤ºå®ƒä»¬æ˜¯æœªå®šä¹‰çš„ã€‚è¿™äº›ç‰¹å®šç¬¦å·æŒ‡çš„æ˜¯å‡ºäºå®‰å…¨åŸå› è‡ªåŠ¨é“¾æ¥çš„ä¸€äº›ç¼“å†²åŒºæº¢å‡ºä¿æŠ¤æ–¹æ³•ä»¥åŠå°†å†…å­˜ä»ä¸€ä¸ªä½ç½®å¤åˆ¶åˆ°å¦ä¸€ä¸ªä½ç½®çš„åŠŸèƒ½ã€‚éœ€è¦å®šä¹‰è¿™äº›å‡½æ•°æ‰èƒ½ä½¿ä»£ç å¯æ‰§è¡Œï¼Œè¿™æ­£æ˜¯é“¾æ¥é˜¶æ®µå’Œå¯é‡ç”¨åº“ï¼ˆå¦‚ libcï¼‰æ‰€æä¾›çš„åŠŸèƒ½ã€‚</p><p>å¥½çš„ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªä¸å®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬æä¾›ä¸€ä¸ª<code>main()</code>æ–¹æ³•å¹¶é“¾æ¥å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ¼”ç¤ºä¸€ä¸‹ï¼Œ <code>ä¾‹ 5-6 ä¸­</code>:</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-6ã€‚è°ƒç”¨æˆ‘ä»¬å‡½æ•°çš„main()æ–¹æ³•ã€‚</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> sum </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The array sum is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sum</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ³¨æ„æˆ‘ä»¬å¿…é¡»å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘ä»¬<code>addArray()</code>å‡½æ•°çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒæ²¡æœ‰åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ã€‚è¯¥ <code>extern</code>å…³é”®å­—è¡¨æ˜å…¶ä»–åœ°æ–¹æœ‰ä¸€ä¸ªæ²¡æœ‰å‚æ•°å’Œè¿”å›ä¸€ä¸ªæ•´æ•°çš„å‡½æ•°ã€‚å› æ­¤ï¼Œå¯ä»¥å°†æ­¤å‡½æ•°çš„æ‰§è¡Œç»“æœèµ‹å€¼ç»™åä¸º<code>sum</code> çš„æ•´æ•°ã€‚ç„¶åå°†å…¶ä¼ é€’åˆ°<code>printf()</code> å‡½æ•°ä¸­ï¼Œå°†å…¶æ ¼å¼åŒ–ä¸€ä¸‹ï¼Œè¾“å‡ºç´¯è®¡æ€»å’Œã€‚</p><p>ä¸ºäº†æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬ç¼–è¯‘<em>simplemain.c</em>å’Œ<em>simple.c</em> æ–‡ä»¶å¹¶å°†ç»“æœå­˜å‚¨åœ¨åä¸º<em>simplemain</em>çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ ã€‚ç°åœ¨æ²¡æœ‰äº†ç¼–è¯‘è­¦å‘Šï¼Œå› ä¸ºæˆ‘ä»¬ç¡®å®ä¸ºè¯¥æ–¹æ³•æä¾›äº†<code>main()</code>å‡½æ•°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang simplemain.c simple.c -o simplemain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -laF simplemain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff  </span><span class="token number" style="color:#36acaa">49640</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">:01 simplemain*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./simplemain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The array </span><span class="token function" style="color:#d73a49">sum</span><span class="token plain"> is: </span><span class="token number" style="color:#36acaa">45</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦‚æœæˆ‘ä»¬åœ¨æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸Šä½¿ç”¨ <code>nm</code> ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬å·²ç»æä¾›äº†è¿™æ¬¡æ‰€éœ€çš„ä¸€åˆ‡ã€‚ç¨‹åºè¿è¡Œæ—¶ï¼Œæœªå®šä¹‰çš„ç¬¦å·åº”ç”±åŠ¨æ€åº“æä¾›ã€‚å®ƒä»¬è¢«æ’é™¤åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å¤–ä»¥å‡å°å¯æ‰§è¡Œæ–‡ä»¶å¤§å°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> nm -a simplemain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U ___stack_chk_fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U ___stack_chk_guard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000100008018 d __dyld_private</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000100000000 T __mh_execute_header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000100003ea0 T _addArray</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000100003e70 T _main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U _memcpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U _printf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 U dyld_stub_binder</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå·¥ä½œç¨‹åºï¼Œè®©æˆ‘ä»¬å›åˆ°<code>ä¾‹ 5-5 ä¸­</code>æ‰€ç¤ºçš„å‡½æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨äº†å­—é¢é‡è¯­æ³•æ¥åˆå§‹åŒ–æ•°ç»„ ï¼Œæ²¡æœ‰æŒ‡å®šæ•°ç»„éœ€è¦å¤šå¤§ï¼Œè¿™æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯ä»¥è®¡ç®—å‡ºæ¥ã€‚åœ¨å†…å­˜ä¸­ï¼Œå®ƒåˆ†é…äº†è¶³å¤Ÿçš„å†…å­˜æ¥ä¿å­˜è¿™ä¹ˆå¤šæ•´æ•°ã€‚è¿™ç§åˆ†é…æ˜¯åœ¨æ ˆä¸Šå®Œæˆçš„ï¼Œå› æ­¤å½“æˆ‘ä»¬ä»å‡½æ•°è¿”å›æ—¶ï¼Œä¸éœ€è¦é¢å¤–çš„æ¸…ç†å·¥ä½œã€‚æˆ‘ä»¬æœ€ç»ˆåœ¨å†…å­˜ä¸­è·å¾—äº†è¶³å¤Ÿå¤§çš„ä½ç½®æ¥å­˜å‚¨æˆ‘ä»¬è¦æ±‡æ€»çš„æ•°å­—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwbnq5eaygj30j603c0so.jpg" alt="image-20211112000518190"></p><p>å¦‚æœæˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨å®ƒéœ€è¦å¤šå¤§ï¼Œç„¶åç»™å®ƒæ›´å¤šçš„æ•°å­—ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿåœ¨<code>ä¾‹ 5-7 ä¸­</code>æˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨æˆ‘ä»¬æ•°ç»„ä¸­åªéœ€è¦äº”ä¸ªæ•´æ•°ï¼Œç„¶åç»™å®ƒåä¸ªã€‚é€šè¿‡ä»¥ä¸‹è®¨è®ºï¼Œæˆ‘å¸Œæœ›å‘æ‚¨å±•ç¤ºç¼–è¯‘å™¨å¦‚ä½•é€šè¿‡æä¾›é”™è¯¯åé¦ˆæ¥å¸®åŠ©æ‚¨åœ¨ç¼–è¾‘ä»£ç æ—¶æ‰¾åˆ°æ›´æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™å‘ç”Ÿåœ¨æˆ‘ä»¬å°è¯•è¿è¡Œä»£ç ä¹‹å‰ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-7ã€‚åŒ…å«é”™è¯¯çš„ç‰ˆæœ¬</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">addArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> retValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retValue </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> retValue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¹¸è¿çš„æ˜¯ï¼Œè¿™å¯¹äºç¼–è¯‘å™¨æ¥è¯´ä¹Ÿå¾ˆå®¹æ˜“æ£€æµ‹åˆ°ã€‚å®ƒä¼šæŒ‡å‡ºæˆ‘ä»¬æ˜¯æ„šè ¢çš„ï¼Œå¹¶ç»™æˆ‘ä»¬ä¸€ä¸ªè­¦å‘Šã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang -c simple.c -o simple.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                 ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> warning generated.</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦‚æœæˆ‘ä»¬æƒ³ä»æˆ‘ä»¬çš„å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªæ•°ç»„ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿåœ¨ <code>ç¤ºä¾‹ 5-8 ä¸­</code>æˆ‘ä»¬å°è¯•è¿™æ ·åšï¼Œä½†å¾ˆå¿«å‘ç°å®ƒä¸èµ·ä½œç”¨ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-8ã€‚ä»å‡½æ•°è¿”å›æ•°ç»„å¤±è´¥ã€‚</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å°½ç®¡æˆ‘ä»¬æ‰€åšçš„çœ‹èµ·æ¥æ˜¯åˆç†çš„ï¼Œä½†ç¼–è¯‘å™¨å†æ¬¡é€šçŸ¥æˆ‘ä»¬æˆ‘ä»¬åšå¾—ä¸å¯¹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang -c simple2.c -o simple2.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">simple2.c:1:22: error: brackets are not allowed here</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> to </span><span class="token builtin class-name">declare</span><span class="token plain"> an array, place the</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brackets after the identifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token function-name function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ~~                ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">simple2.c:1:20: error: </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> cannot </span><span class="token builtin class-name">return</span><span class="token plain"> array </span><span class="token builtin class-name">type</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;int []&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token function-name function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">simple2.c:3:10: warning: incompatible pointer to integer conversion returning </span><span class="token string" style="color:#e3116c">&#x27;int [10]&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from a </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> with result </span><span class="token builtin class-name">type</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;int&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-Wint-conversion</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ^~~~~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">simple2.c:3:10: warning: address of stack memory associated with </span><span class="token builtin class-name">local</span><span class="token plain"> variable </span><span class="token string" style="color:#e3116c">&#x27;array&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">returned </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-Wreturn-stack-address</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ^~~~~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> warnings and </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> errors generated.</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ•°ç»„åç§°æ˜¯ C ä¸­çš„ç‰¹æ®Šå˜é‡ã€‚å®ƒä»¬æ˜¯å†…å­˜ä¸­å­˜å‚¨è¿™äº›å€¼çš„è¿ç»­å†…å­˜å—çš„åœ°å€çš„å ä½ç¬¦ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼Œå¹¶å°†å…¶åˆ†é…ç»™æ•°ç»„å¼€å¤´çš„ä½ç½®ã€‚ä¸ºäº†è®¿é—®è¯¥ä½ç½®çš„å€¼ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦<code>*</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-9ã€‚ä½¿ç”¨æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;a is %p\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The first value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The second value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The third value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå€¼ä½äºæ•°ç»„çš„å¼€å¤´ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>*a</code>. ç¬¬äºŒä¸ªæ•´æ•°é—´éš”äº†ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œå› æ­¤æˆ‘ä»¬åœ¨åŸºå€ä¸ŠåŠ ä¸ª1ï¼Œå†å–å€¼ã€‚ç¬¬ä¸‰ä¸ªå€¼é—´éš”ä¸¤ä¸ªå†…å­˜ã€‚</p><p>ç¼–è¯‘æˆ‘ä»¬çš„ç¨‹åºå¹¶è¿è¡Œå®ƒï¼ŒæŸ¥çœ‹è¾“å‡ºã€‚æ‚¨<code>a</code>åœ°å€çš„å€¼å’Œæˆ‘å¯èƒ½ä¸å¤ªç›¸åŒï¼Œä½†çœ‹èµ·æ¥åº”è¯¥ç›¸ä¼¼ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang simple3.c -o simple3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./simple3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a is 0x7ffeef3a9720</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The first value is: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The second value is: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The third value is: </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç¼–è¯‘å™¨åœ¨`ç¤ºä¾‹ 5-8 ä¸­æŠ¥é”™çš„åŸå›  æ˜¯å› ä¸ºæ‚¨æ— æ³•åƒæˆ‘ä»¬å°è¯•çš„é‚£æ ·è¿”å›æ•°ç»„ã€‚ç›¸åï¼Œæ‚¨å¿…é¡»è¿”å›ä¸€ä¸ªæŒ‡é’ˆã€‚</p><p>æˆ‘ä»¬åœ¨<code>ä¾‹ 5-10 ä¸­</code>å†æ¬¡å°è¯•è¿”å›æˆ‘ä»¬çš„æ•°ç»„:</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-10ã€‚ä»å‡½æ•°è¿”å›æ•°ç»„çš„å¦ä¸€ä¸ªå¤±è´¥å°è¯•ã€‚</div><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;a is %p\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The first value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The second value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The third value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å†ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¤±è´¥äº†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang simple4.c -o simple4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">simple4.c:5:10: warning: address of stack memory associated with </span><span class="token builtin class-name">local</span><span class="token plain"> variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;array&#x27;</span><span class="token plain"> returned </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-Wreturn-stack-address</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ^~~~~</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> warning generated.</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™æ¬¡ç¼–è¯‘å™¨å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬æ­£åœ¨è¿”å›å¯¹æ ˆä¸­å†…å­˜çš„å¼•ç”¨ã€‚å¦‚æœä½ è¿˜è®°å¾—æˆ‘ä¸Šé¢æ‰€è¯´çš„å…³äºå½“æˆ‘ä»¬ä»å‡½æ•°è¿”å›æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æˆ‘ä»¬çš„æŒ‡é’ˆæŒ‡å‘çš„æ˜¯åœ¨æˆ‘ä»¬æœ‰æœºä¼šä½¿ç”¨å®ƒä¹‹å‰å°±å°†è¢«ä¸¢å¼ƒçš„å†…å­˜ã€‚</p><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦åœ¨å †ä¸Šåˆ†é…å†…å­˜çš„èƒ½åŠ›ã€‚å®ƒä¼šä¸€ç›´æœ‰æ•ˆï¼Œç›´åˆ°æˆ‘ä»¬å‘Šè¯‰ C è¿è¡Œæ—¶æˆ‘ä»¬ä¸å†éœ€è¦å®ƒã€‚åœ¨å †ä¸Šåˆ†é…å†…å­˜çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ <code>malloc()</code>å‡½æ•°ã€‚</p><p>æˆ‘ä»¬ç»ˆäºåœ¨<code>ä¾‹ 5-11 ä¸­</code>å¾—åˆ°äº†ä¸€ä¸ªæœ‰æ•ˆçš„ä»£ç ç¤ºä¾‹ã€‚ <code>malloc()</code>å‡½æ•°ç”±Cæ ‡å‡†åº“æä¾›ï¼Œå› æ­¤æˆ‘ä»¬åœ¨å…¶å®šä¹‰ä¸­åŒ…å«å¦ä¸€ä¸ªå¤´æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦å‘Šè¯‰è¿™ä¸ªå‡½æ•°åˆ†é…å¤šå°‘å†…å­˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨æ•´æ•°å¤§å°çš„ä¸€äº›å€æ•°ã€‚å¥½æ¶ˆæ¯æ˜¯æˆ‘ä»¬ç°åœ¨ä¹Ÿå¯ä»¥åˆ›å»ºä»»æ„å¤§çš„æ•°ç»„ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬å°†å¤§å°åŠ å€åˆ° 20ï¼Œç„¶åè¿­ä»£ 0 åˆ° 19 ä¹‹é—´çš„æ•°å­—ä»¥å¡«å……æˆ‘ä»¬çš„æ•°ç»„ã€‚æœ€åæˆ‘ä»¬è¿”å›ç»“æœï¼Œå¹¶åœ¨<code>main()</code> æ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ª<code>int *</code>ã€‚ å°½ç®¡æˆ‘ä»¬ç°åœ¨æŒ‡å‘çš„æ˜¯å †è€Œä¸æ˜¯æ ˆï¼Œä½†å®ƒçš„è¡Œä¸ºå°±åƒæˆ‘ä»¬åœ¨<code>ç¤ºä¾‹ 5-9</code>ä¸­çš„<code>int *</code>ä¸€æ ·ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c"><pre tabindex="0" class="prism-code language-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdlib.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> array </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    array</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> array</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generateArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;a is %p\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The first value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The second value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The third value is: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç¼–è¯‘å’Œè¿è¡Œæˆ‘ä»¬çš„æ–°ç¨‹åºï¼Œç»ˆäºç»™äº†æˆ‘ä»¬ä¸€äº›ä¹è¶£ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> clang simple5.c -o simple5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/ch0</span><span class="token operator file-descriptor important" style="color:#393A34">5</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./simple5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a is 0x7fae22c059e0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The first value is: </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The second value is: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The third value is: </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç„¶è€Œï¼Œæˆ‘ä»¬çš„ç¨‹åºä¸­ä»ç„¶å­˜åœ¨ä¸€ä¸ªç¼ºé™·ã€‚å› ä¸ºæˆ‘ä»¬æ‰“å°å‡ºç»“æœç„¶åå°±é€€å‡ºäº†ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†å´æ˜¯äº§ç”Ÿäº†ä¸€ç§è®© C ç¨‹åºå‘˜ï¼ˆåŠå…¶ç”¨æˆ·ï¼‰å‘ç–¯çš„é—®é¢˜ï¼šæˆ‘ä»¬å¿˜è®°é‡Šæ”¾æˆ‘ä»¬åˆ†é…çš„å†…äº†ï¼å¦‚æœè¿™æ˜¯ä¸€ä¸ªæœåŠ¡å™¨æˆ–ä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ç¨‹åºï¼Œå¹¶ä¸”æˆ‘ä»¬å¤šæ¬¡è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œæˆ‘ä»¬æœ€ç»ˆå¯èƒ½ä¼šè€—å°½å†…å­˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨<code>free()</code>å‡½æ•°æ¥å‘Šè¯‰è¿è¡Œæ—¶æˆ‘ä»¬å·²ç»å®Œæˆäº†è¯¥å†…å­˜çš„ä½¿ç”¨ã€‚ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å†ç¢°å®ƒäº†ã€‚ä¸‹é¢åˆ—ä¸¾äº†åœ¨ç”¨ C ç¼–å†™ç¨‹åºæ—¶éœ€è¦è€ƒè™‘çš„è®¸å¤šé—®é¢˜ä¸­çš„ä¸€äº›ã€‚</p><ul><li>åœ¨åˆ†é…ä¹‹å‰ä¸è¦ä½¿ç”¨å†…å­˜ã€‚</li><li>åˆ†é…çš„å†…å­˜è¦ç¡®ä¿å®ƒä»¬è¶³å¤Ÿå¤§ã€‚</li><li>å®Œæˆåä¸è¦å¿˜è®°é‡Šæ”¾å†…å­˜ã€‚</li><li>é‡Šæ”¾å†…å­˜åä¸è¦ä½¿ç”¨å®ƒã€‚</li></ul><p>å¿˜è®°è¿™äº›è§„åˆ™ä¸­çš„ä»»ä½•ä¸€æ¡éƒ½å¯èƒ½å¯¼è‡´æ‚¨çš„ç¨‹åºå´©æºƒæˆ–å†…å­˜ä¸è¶³ã€‚å¦‚æœè¿™çœ‹èµ·æ¥å¾ˆéº»çƒ¦ï¼Œæ‚¨ä¼šå–œæ¬¢ Javaã€Python å’Œ JavaScript ç­‰è¯­è¨€ï¼Œå®ƒä»¬ä¸ºæ‚¨ç¼“è§£äº†å…¶ä¸­çš„ä¸€äº›é—®é¢˜ã€‚ä¸åˆ©çš„ä¸€é¢æ˜¯é€šå¸¸å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œè¿™å°±æ˜¯ Rust å¦‚æ­¤å¼•äººæ³¨ç›®çš„åŸå› ã€‚å®ƒä¸ºæ‚¨æä¾›äº†åƒ C è¿™æ ·çš„è¯­è¨€çš„é€Ÿåº¦ï¼Œè€Œæ²¡æœ‰åƒ C è¿™æ ·çš„è¯­è¨€çš„å±é™©ã€‚æˆ‘ä»¬å°†åœ¨<code>ç¬¬ 10 ç« </code>ä»‹ç» Rust ã€‚</p><p>åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šæ‰€æœ‰è¿™äº›å¯¹ WebAssembly æ„å‘³ç€ä»€ä¹ˆã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="cc-å’Œ-webassembly">C/C++ å’Œ WebAssembly<a aria-hidden="true" class="hash-link" href="#cc-å’Œ-webassembly" title="Direct link to heading">â€‹</a></h2><p>åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨åŸºäº Petter Strandmark æä¾›çš„ç¤ºä¾‹é¡¹ç›®æ¼”ç¤ºæ›´å¤æ‚çš„åŸºç¡€è®¾æ–½ï¼Œä»¥ä¾¿å°† clang å’Œ WebAssembly ç»“åˆèµ·æ¥ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç» Emscripten å·¥å…·é“¾ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°å°†ç°æœ‰ä»£ç ç§»æ¤åˆ° WebAssemblyã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å°†å¼•å…¥ WebAssembly æœåŠ¡æ¥å£ (WASI) æ¥å¤„ç†è¿™äº›ç»†èŠ‚ï¼Œä½†åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›åŸºç¡€è®¾æ–½æ¥å¸®åŠ©æˆ‘ä»¬å…‹æœç›®å‰æ‰€é‡åˆ°çš„éšœç¢ã€‚</p><p>è¿™ä¸ªåŸºç¡€è®¾æ–½æœ‰å‡ ä¸ªéƒ¨åˆ†ï¼Œä½†å®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç‹¬ç«‹çš„ï¼Œæˆ‘è®¤ä¸ºè¿˜æ˜¯æ¯”è¾ƒå¥½ç†è§£çš„ã€‚å‡ºäºç›®å‰ä¸å€¼å¾—æ·±å…¥ç ”ç©¶çš„åŸå› ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ C++ ç‰ˆæœ¬çš„ clang ç¼–è¯‘å™¨ã€‚æˆ‘ä»¬ä¹Ÿæ²¡æœ‰æ—¶é—´åœ¨æœ¬ç« ä¸­æ•™ä½  C++ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šä¸“æ³¨äºå¤ªå¤šç»†èŠ‚ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è®© C++ ä»£ç è¡¨ç°å¾—åƒ Cã€‚</p><p>æˆ‘ä»¬å°†ä»ä¸€äº› C/C++ ä»£ç å¼€å§‹ã€‚è¿™ä¸¤ç§è¯­è¨€éå¸¸ç›¸å…³ï¼Œä½†æ˜¯ C++ æä¾›äº†é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ç‰¹æ€§ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ä½¿ç”¨è‡ªç„¶æ¦‚å¿µï¼ˆä¾‹å¦‚è®¢å•ã€å¸æˆ·ã€ç”¨æˆ·ç­‰ï¼‰å¯¹é¢†åŸŸè¿›è¡Œå»ºæ¨¡ã€‚åœ¨<code>ç¤ºä¾‹ 5-12 ä¸­</code>æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ä¸€äº›åŠŸèƒ½ã€‚ä¸ºäº†ä½¿äº‹æƒ…æ˜“äºç®¡ç†ï¼Œæ­¤æ—¶æˆ‘ä¸ä¼šå‘æ‚¨å±•ç¤ºæ‰€æœ‰å†…å®¹ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-12ã€‚ä¸€äº› C/C++ å‡½æ•°ä¾›æˆ‘ä»¬è°ƒç”¨</div><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;nanolibc/libc.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;nanolibc/libc_extra.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define WASM_EXPORT __attribute__((visibility(&quot;default&quot;))) extern &quot;C&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WASM_EXPORT int* get_memory_for_int_array(int size) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return new int[size];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WASM_EXPORT void free_memory_for_int_array(int* arr) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  delete[] arr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WASM_EXPORT void mergeSort(char *p, int length) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int c, d, swap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for(c = 0; c &lt; length - 1; c++ ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    for( d = 0; d &lt; length - c - 1; d++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if(p[d] &gt; p[d+1]) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swap = p[d];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p[d] = p[d+1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p[d+1] = swap;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WASM_EXPORT void reverse(unsigned char* p, int len) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for( int i = 0; i &lt; len / 2; i++ ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     unsigned char temp = p[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     p[i] = p[len - i - 1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     p[len - i - 1] = temp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>é¦–å…ˆä½ å¾—æ˜ç™½<code>#include</code> åŒ…å«çš„ä»£ç ã€‚æ­¤ä»£ç ä½¿ç”¨ä¸€ä¸ªéå¸¸å°çš„å®ç°ï¼Œä¸ºæˆ‘ä»¬æä¾›libcåº“çš„<code>malloc()</code>ï¼Œ <code>free()</code>ç”šè‡³<code>printf()</code>ï¼ˆæš‚æ—¶å…ˆä¸ç®¡è¿™ä¸ªå‡½æ•°ï¼‰ã€‚C/C++ ä¸­çš„å¤´æ–‡ä»¶å…è®¸æˆ‘ä»¬å£°æ˜å‡½æ•°çš„ç­¾åï¼Œä»¥ä¾¿ç¼–è¯‘å™¨çŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><p>æ­£å¦‚ä½ åœ¨<code>ä¾‹ 5-13 ä¸­</code>çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬æœ‰ä¸€ç»„å¯ä¾›æˆ‘ä»¬é“¾æ¥çš„å‡½æ•°ã€‚ä¸ºäº†ç¡®ä¿å®ƒä»¬åœ¨ C å‡½æ•°ä¸­å¯è§ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>extern &quot;C&quot;</code>å…³é”®å­—æ¥é˜²æ­¢ C++ ç¼–è¯‘å™¨ä¿®æ”¹å®ƒä»¬çš„åç§°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#ifndef _NANOLIB_C_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define _NANOLIB_C_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdarg.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stddef.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extern &quot;C&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void* memcpy(void* dest, const void* src, size_t count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void* memset (void * dest, int value, size_t count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int puts ( const char * str );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int printf(const char* format, ...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int sprintf(char* buffer, const char* format, ...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int snprintf(char* buffer, size_t count, const char* format, ...);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int vsnprintf(char* buffer, size_t count, const char* format, va_list va);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void* malloc(size_t amount);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void* realloc(void *ptr, size_t size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void* calloc(size_t num, size_t size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void free(void* mem);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å›é¡¾<code>ç¤ºä¾‹ 5-12</code>æˆ‘ä»¬æœ‰ä¸€ä¸ªå«åš<code>get_memory_for_int_array()</code>çš„æ–¹æ³• ï¼Œå®ƒæ¥å—ä¸€ä¸ª<code>size</code>å‚æ•°æ¥å‘Šè¯‰æˆ‘ä»¬è¦åˆ†é…å¤šå°‘å†…å­˜ã€‚å¦‚æœæ‚¨ä»”ç»†æŸ¥çœ‹å®ç°ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ C++ çš„<code>new</code>è¿ç®—ç¬¦ã€‚æˆ‘ä»¬å‡è®¾è¿™ä¸<code>malloc()</code>çš„å«ä¹‰ç›¸åŒã€‚é€šè¿‡ä½¿ç”¨<code>delete</code>è¿ç®—ç¬¦ï¼Œ <code>free_memory_for_int_array()</code>å‡½æ•°çš„ä½œç”¨ç±»ä¼¼äº <code>free()</code>ã€‚</p><p>æœ‰ä¸€ä¸ª<code>#define</code>å®å¯ä»¥ä¸ºè¿™äº›å‡½æ•°æä¾›å¤–éƒ¨å¯è§æ€§ï¼Œä»¥ç¡®ä¿å®ƒä»¬å¯ç”¨äºæˆ‘ä»¬å°†è¦è°ƒç”¨å®ƒä»¬çš„ JavaScript ä»£ç ã€‚</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå½’å¹¶æ’åºçš„å®ç°ï¼Œå¦ä¸€ä¸ªå‡½æ•°ç”¨äºåè½¬æ•°å­—æ•°ç»„ã€‚</p><p>C/C++ åº”ç”¨ç¨‹åºå’Œåº“çš„æ„å»ºç³»ç»Ÿä¸åƒ Rust çš„ cargo å‘½ä»¤é‚£æ ·ç°ä»£å’Œå‹å¥½ï¼Œä½†å®ƒä»¬æ˜¯å¯é å’Œçµæ´»çš„ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªç®€å•çš„åŸºäº<em>Makefile</em>çš„æ–¹æ³•ã€‚è¿™æ˜¯æˆ‘ä»¬æ²¡æœ‰æ—¶é—´æ·±å…¥è®¨è®ºçš„å¦ä¸€ä¸ªç»†èŠ‚ï¼Œç®€å•æ¥è¯´ä»–å°±æ˜¯å®šä¹‰äº†ä¸€ç»„è§„åˆ™æ¥æ„å»ºç›®æ ‡ã€‚å½“æºä»£ç æ›´æ”¹æ—¶ï¼Œå®ƒä¼šå¯¼è‡´é‡æ–°è¯„ä¼°ä¾èµ–é¡¹å¹¶æ„å»ºä»»ä½•éœ€è¦æ„å»ºçš„ä¸œè¥¿ã€‚å¦‚æœæ‚¨æƒ³äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¯ä»¥é€šè¿‡æœ¬ä¹¦çš„ Git Repoè·å¾—è¯¥æ–‡ä»¶çš„å†…å®¹ã€‚</p><p>ä¸ºäº†æ„å»ºæˆ‘ä»¬çš„ä»£ç ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ make å‘½ä»¤ï¼Œå®ƒä¼šè®©æˆ‘ä»¬çŸ¥é“å®ƒæ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/c/helloworld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. Lots of noise goes by</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/c/helloworld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -laF *.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> brian  staff  </span><span class="token number" style="color:#36acaa">5309</span><span class="token plain"> Feb </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">:03 library.wasm*</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æˆ‘å°†ç•™ç»™æ‚¨è‡ªå·±è¯¦ç»†æ¢ç´¢è¯¥æ¨¡å—çš„å†…å®¹ï¼Œä½†æˆ‘æƒ³é‡ç‚¹ä»‹ç»å…¶ä¸­çš„ä¸€äº›è¦ç‚¹ã€‚æ³¨æ„æˆ‘ä»¬çš„æ¨¡å—å¯¼å‡ºäº†è‡ªå·±çš„å†…å­˜ã€‚æ‚¨å¯ä»¥æ›´æ”¹æ­¤è¡Œä¸ºï¼Œä» JavaScript ç«¯å¯¼å…¥<code>Memory</code>çš„å®ä¾‹ï¼Œä½†æˆ‘ä»¬ç°åœ¨ä¸æ‰“ç®—è¿™æ ·åšã€‚</p><p>ç›®å‰ä½ éœ€è¦å…³æ³¨çš„æ˜¯ï¼Œæˆ‘ä»¬çš„ C/C++ ä»£ç æœ‰ä¸€ä¸ª libc çš„å¾®å°å®ç°ï¼Œå®ƒå°†ä»ä¸€ä¸ªå¯¼å‡ºçš„<code>Memory</code>å®ä¾‹ä¸­åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">brian@tweezer ~/g/w/s/c/helloworld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> wasm-objdump -x library.wasm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Export</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - memory</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;memory&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">get_memory_for_int_array</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;get_memory_for_int_array&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">_Znam</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_Znam&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">free_memory_for_int_array</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;free_memory_for_int_array&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">_ZdaPv</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_ZdaPv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">debug_dump_memory</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;debug_dump_memory&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">mergeSort</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mergeSort&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">reverse</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;reverse&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">helloWorld</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;helloWorld&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">_Znwm</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_Znwm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - func</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">_ZdlPv</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;_ZdlPv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€äº› HTML ä»£ç æ¥è°ƒç”¨æˆ‘ä»¬çš„ C/C++ ã€‚å¤§éƒ¨åˆ†ç»“æ„ä¸æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ç›¸ä¼¼ï¼Œä½†æˆ‘å°†åœ¨<code>ç¤ºä¾‹ 5-14 ä¸­</code>é‡ç‚¹ä»‹ç»æ‚¨éœ€è¦äº†è§£çš„éƒ¨åˆ†ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">let</span><span class="token script language-javascript"> wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript spread operator" style="color:#393A34">...</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript known-class-name class-name">WebAssembly</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">instantiateStreaming</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript function" style="color:#d73a49">fetch</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&#x27;library.wasm&#x27;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> importObject</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">then</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">obj</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">1</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    wasm </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> obj</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">2</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> ptr </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">get_memory_for_int_array</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">3</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> memory </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">Uint8Array</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">memory</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">buffer</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">4</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> nums </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> memory</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">subarray</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">ptr</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">5</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">for</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> i </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> i </span><span class="token script language-javascript operator" style="color:#393A34">&lt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> i</span><span class="token script language-javascript operator" style="color:#393A34">++</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      nums</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript">i</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> i</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">nums</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">reverse</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">ptr</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">6</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">nums</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> arr </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">1</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">2</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">3</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">4</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">5</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">6</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">7</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">8</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">9</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">7</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#d73a49">shuffleArray</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">arr</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">for</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript keyword" style="color:#00009f">var</span><span class="token script language-javascript"> i </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> i </span><span class="token script language-javascript operator" style="color:#393A34">&lt;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> i</span><span class="token script language-javascript operator" style="color:#393A34">++</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      nums</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript">i</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> arr</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript">i</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">nums</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">mergeSort</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">ptr</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">10</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">8</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">nums</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">free_memory_for_int_array</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">ptr</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">9</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript spread operator" style="color:#393A34">...</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><ol><li>ä¸å¾€å¸¸ç›¸åŒçš„æ–¹å¼åˆ›å»ºModule</li><li>ä¸€æ—¦å¯ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨å…¶ä»–åœ°æ–¹è®¿é—®æ¨¡å—å®ä¾‹ã€‚</li><li>æ¨¡å—ä¸­ä¸ºåä¸ªæ•´æ•°åˆå§‹åŒ–äº†è¶³å¤Ÿçš„ç©ºé—´ã€‚æˆ‘ä»¬æ•è·è¿”å›çš„â€œæŒ‡é’ˆâ€ã€‚</li><li>åº•å±‚ç¼“å†²åŒºç”¨<code>Uint8Array</code>.</li><li><code>Uint8Array</code>åˆ›å»ºä¸€ä¸ª sub-æ¥è¦†ç›–å…ˆå‰è¿”å›çš„â€œæŒ‡é’ˆâ€æ‰€å¼•ç”¨çš„éƒ¨åˆ†ã€‚</li><li>æ¨¡å—ä¸­çš„<code>reverse()</code>æ–¹æ³•è¢«è°ƒç”¨ã€‚</li><li>æˆ‘ä»¬ä¾é  JavaScript åŠŸèƒ½æ¥æ‰“ä¹±ä¸€äº›æ•°æ®ã€‚</li><li>è¯¥<code>mergeSort()</code>æ–¹æ³•æ˜¯é€šè¿‡å¯¹â€œæŒ‡é’ˆâ€çš„å¼•ç”¨æ¥è°ƒç”¨çš„ã€‚</li><li>å†…å­˜åœ¨Moduleç«¯è¢«é‡Šæ”¾ã€‚</li></ol><p>æˆ‘ä»¬é¦–å…ˆåƒä¹‹å‰æ‰€åšçš„é‚£æ ·å¯åŠ¨ HTTP Serverã€‚moduleçš„ä½¿ç”¨å’ŒåŠ è½½éƒ½å’Œä¹‹å‰ä¸€æ ·ã€‚ä¸€æ—¦moduleå®ä¾‹å¯ç”¨ï¼Œæˆ‘ä»¬å°†å˜é‡åˆ†é…ç»™åœ¨æ­¤å—çš„è¯æ³•èŒƒå›´ä¹‹å¤–å®šä¹‰çš„å¦ä¸€ä¸ªå˜é‡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨å®ƒã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä»£ç çš„ C/C++ ç«¯ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å¿…é¡»ä»å®ƒçš„è§’åº¦åˆ†é…è¶³å¤Ÿçš„å†…å­˜æ¥å­˜å‚¨ JavaScript ç«¯çš„ä¸€äº›æ•°æ®ã€‚ä»¥å‰æˆ‘ä»¬åªæ˜¯ç›´æ¥å°†æ•°æ®å†™å…¥å¯¼å‡ºçš„<code>Memory</code>å®ä¾‹ä¸­ã€‚å› ä¸ºæˆ‘ä»¬è¦æ¨¡æ‹ŸæŒ‡é’ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»åœ¨è¿™ä¸€ä¾§åˆ›å»ºä¸€äº›çœ‹èµ·æ¥åˆé€‚çš„ä¸œè¥¿ã€‚æˆ‘ä»¬è°ƒç”¨è¯¥<code>get_memory_for_int_array()</code> å‡½æ•°å¹¶è¦æ±‚å®ƒåˆ†é…åä¸ªæ•´æ•°ç©ºé—´ã€‚è¯¥å‡½æ•°åœ¨ C/C++ ç«¯è¿”å›ä¸€ä¸ªæŒ‡é’ˆã€‚æ­£å¦‚æ‚¨ä¹‹å‰çœ‹åˆ°çš„é‚£æ ·ï¼Œå®ƒä¸æ˜¯ç›´æ¥å¼•ç”¨å †ä¸­çš„æŸä¸ªä½ç½®ã€‚ç›¸åï¼Œå®ƒæ˜¯å°å‹ libc å®ç°å°†æ•°æ®åˆ†é…åˆ°çš„åº•å±‚ç¼“å†²åŒºçš„ç´¢å¼•ã€‚å½“æˆ‘ä»¬å°†å®ƒä¼ å›å¦ä¸€ä¾§æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ­¤å¼•ç”¨ä½œä¸ºå†…å­˜ä¸­çš„åç§»é‡ã€‚</p><p>æˆ‘ä»¬<code>ArrayBuffer</code>ç”¨ä¸€ä¸ª<code>Uint8Array</code>åŒ…è£…å™¨å°†åº•å±‚åŒ…å›´èµ·æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»è¿™ä¸€è¾¹å†™å‡º 8 ä½æ•´æ•°ã€‚å¦‚æœæ‚¨é‡æ–°æŸ¥çœ‹<code>ç¤ºä¾‹ 5-12 ä¸­</code>çš„ä»£ç ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°æˆ‘ä»¬çš„æ’åºå’Œåè½¬å‡½æ•°æ¥å—<code>char *</code>ã€‚é€šè¿‡åœ¨<code>ints</code>ã€<code>chars</code>ã€ addressesã€booleans ç­‰ ä¹‹é—´è¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ŒC å¯ä»¥éå¸¸çµæ´»ã€‚å®ƒéå¸¸çµæ´»ï¼Œè€Œä¸”ç»å¸¸æœ‰å¾ˆå¤šé—®é¢˜ã€‚è¿™äº›<code>chars</code>ä¸èƒ½å¤§äº 8 ä½ï¼Œå› æ­¤å®ƒä»¬çš„æœ€å¤§å¤§å°ä¸º 255ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ç”¨ ä¸€ä¸ª<code>Uint8Array</code>åŒ…è£…ç¼“å†²åŒºã€‚</p><p>ä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨<code>reverse()</code>å‡½æ•°ã€‚</p><p>ä¸ºäº†å±•ç¤ºæ’åºåŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ‰“ä¹±çš„æ•°æ®ã€‚</p><p>ä¸€ä¸ªæ–°åˆ›å»ºçš„æ•°ç»„è¢«å¡«å……ã€æ‰“ä¹±å¹¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>å½“æˆ‘ä»¬è¿”å› JavaScript æ—¶ï¼Œæˆ‘ä»¬å°†ç»“æœè½¬å‚¨åˆ°æ§åˆ¶å°ï¼Œç„¶åé‡Šæ”¾æˆ‘ä»¬åˆ†é…çš„å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†ä½¿ç”¨å®ƒã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="æœ€å-webassembly-ä¸­çš„hello-world">æœ€åï¼Œ WebAssembly ä¸­çš„â€œHello, world!â€<a aria-hidden="true" class="hash-link" href="#æœ€å-webassembly-ä¸­çš„hello-world" title="Direct link to heading">â€‹</a></h2><p>æˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šä¸œè¥¿è¦å‘æ‚¨å±•ç¤ºï¼Œä½†æ˜¯ï¼Œç°åœ¨æ˜¯æˆ‘å…‘ç°ç»™æ‚¨ä¸€ä¸ªâ€œHelloï¼ŒWorldï¼â€æ‰¿è¯ºçš„æ—¶å€™äº†ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä¸ä¼šæœ‰ä¸€ä¸ªå…¸å‹çš„<code>main()</code>ç¨‹åºã€‚ç›¸åï¼Œæˆ‘ä¼šå°†è¿™ä¸ªè¡Œä¸ºä½œä¸º<em>library.cpp</em>æ–‡ä»¶ä¸­çš„å¦ä¸€ä¸ªå‡½æ•°å…¬å¼€ã€‚<code>ç¤ºä¾‹ 5-15</code>å‘æ‚¨å±•ç¤ºäº†è¿™æ˜¯å¤šä¹ˆç®€å•ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-15 C/C++ ä»£ç ä¸­çš„hello worldå‡½æ•°</div><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">WASM_EXPORT void helloWorld() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printf(&quot;Hello, World!\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>å¦‚æœæˆ‘åœ¨ HTML ä¸­çš„å…¶ä»–ä»£ç ä¹‹åæ·»åŠ å¯¹è¿™ä¸ªæ–°å‡½æ•°çš„è°ƒç”¨ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç»“æœã€‚</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwbpn5hln1j30za07ogmn.jpg" alt="image-20211112011139530"></p><p>è¿™åˆ°åº•æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼ï¼Ÿï¼å¦‚æœå®ƒè¿™ä¹ˆå®¹æ˜“ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç­‰åˆ°<code>ç¬¬äº”ç« </code>ç»“æŸæ‰èƒ½çœ‹åˆ°å®ƒï¼Ÿ</p><p>è®©æˆ‘å‘æ‚¨å±•ç¤º<code>ç¤ºä¾‹ 5-16 ä¸­</code>HTML ä¸­çš„æ›´å¤šç»†èŠ‚ ã€‚æœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°è°ƒç”¨<code>get_memory()</code>ï¼Œå®ƒåªè¿”å›ä¸€ä¸ª<code>Uint8Array</code>å®ä¾‹ã€‚æœ‰<code>decoder</code>å’Œ <code>encoder</code>å˜é‡å¯ç”¨äºåœ¨å­—ç¬¦ä¸²UTF-8 è¡¨ç¤ºä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚æœ‰ä¸€ä¸ªå‡½æ•° <code>charPtrToString()</code>å¯ä»¥å°†â€œå­—ç¬¦æŒ‡é’ˆâ€ï¼ˆå³ C å­—ç¬¦ä¸²ï¼‰è½¬æ¢ä¸º UTF-8 å­—ç¬¦ä¸²ä¾› JavaScript ä½¿ç”¨ã€‚</p><p>å†å¾€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¢«è°ƒç”¨çš„<code>printString()</code>å‡½æ•°ï¼Œå®ƒå°†JavaScript å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚æˆ‘ä»¬ çš„<code>importObject</code>é…ç½®äº†ä¸€ä¸ª<code>print_string</code>ï¼Œè¯¥æ–¹æ³• å°†åœ¨è¾“å‡ºåˆ°æ§åˆ¶å°ä¹‹å‰å°†â€œå­—ç¬¦æŒ‡é’ˆâ€è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ <code>importObject</code>ï¼Œä½ è¿˜è®°å¾—å—ï¼Œèƒ½å¤Ÿä½¿æˆ‘ä»¬ä¸æˆ‘ä»¬çš„æ¨¡å—å®ä¾‹å…±äº«åŠŸèƒ½å’Œæ•°æ®ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-16ã€‚Hello, World!çš„å¹•åå·¥ä½œ</div><div class="codeBlockContent_hGly html"><pre tabindex="0" class="prism-code language-html codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">get_memory</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">return</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">Uint8Array</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">wasm</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">instance</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">exports</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">memory</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">buffer</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> decoder </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">TextDecoder</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;utf-8&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> encoder </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">new</span><span class="token script language-javascript"> </span><span class="token script language-javascript class-name">TextEncoder</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;utf-8&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">charPtrToString</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">str</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> memory </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript function" style="color:#d73a49">get_memory</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword" style="color:#00009f">let</span><span class="token script language-javascript"> length</span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">for</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"> memory</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript">str </span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript"> length</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">!==</span><span class="token script language-javascript"> </span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript operator" style="color:#393A34">++</span><span class="token script language-javascript">length</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript keyword control-flow" style="color:#00009f">return</span><span class="token script language-javascript"> decoder</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">decode</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">memory</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">subarray</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">str</span><span class="token script language-javascript punctuation" style="color:#393A34">,</span><span class="token script language-javascript"> str </span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript"> length</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">let</span><span class="token script language-javascript"> </span><span class="token script language-javascript function-variable function" style="color:#d73a49">printString</span><span class="token script language-javascript"> </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">str</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript console class-name">console</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">log</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">str</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript keyword" style="color:#00009f">const</span><span class="token script language-javascript"> importObject </span><span class="token script language-javascript operator" style="color:#393A34">=</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  env</span><span class="token script language-javascript operator" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript function-variable function" style="color:#d73a49">print_string</span><span class="token script language-javascript operator" style="color:#393A34">:</span><span class="token script language-javascript"> </span><span class="token script language-javascript keyword" style="color:#00009f">function</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript parameter">str</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript"> </span><span class="token script language-javascript punctuation" style="color:#393A34">{</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript function" style="color:#d73a49">printString</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript function" style="color:#d73a49">charPtrToString</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript">str</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">  </span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript punctuation" style="color:#393A34">}</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript spread operator" style="color:#393A34">...</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>è¿™æ˜¯ JavaScript è¿™è¾¹çš„ã€‚åœ¨ C/C++ æ–¹é¢ï¼Œæˆ‘ä»¬åœ¨ <code>ç¤ºä¾‹ 5-17 ä¸­</code>çœ‹åˆ°ï¼Œ<em>nanolibc/libc_extra.h</em>å¤´æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸ºçš„å‡½æ•°<code>print_string()</code>ï¼Œè¯¥å‡½æ•°é‡‡ç”¨<code>char *</code>.</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-17ã€‚å°† JavaScript å‡½æ•°å…¬å¼€ä¸º C å‡½æ•°ã€‚</div><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">#ifndef _NANOLIB_C_EXTRA_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define _NANOLIB_C_EXTRA_H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extern &quot;C&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Will be provided by Javascript.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void print_string(const char* str);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p><code>printf()</code>åœ¨<em>nanolibc</em> ç›®å½•ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶å®šä¹‰äº†æˆ‘ä»¬çš„å®ä¾‹ã€‚é‚£é‡Œçš„ç»†èŠ‚å¾ˆå¤æ‚ï¼Œæ‰€ä»¥æˆ‘ä¸æƒ³æ·±å…¥ç ”ç©¶ï¼Œä½†æˆ‘ä¼šæŒ‡å‡ºå®ƒè°ƒç”¨<code>puts()</code>å°† a<code>char *</code>æ”¾åˆ°è¾“å‡ºæ§åˆ¶å°ã€‚é€šå¸¸ï¼Œè¿™æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ä½çº§æœåŠ¡ï¼Œä½†æ ¹æ®æ‚¨ç›®å‰æ‰€è§ï¼Œä¸€æ—¦æˆ‘ä»¬åœ¨<code>ç¤ºä¾‹ 5-18 ä¸­</code>è¿æ¥äº†æœ€åä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„ JavaScript å¤„ç†ç¨‹åºå°±ä¼šå°†å…¶è·¯ç”±åˆ°å…¶æ§åˆ¶å°ã€‚</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">ä¾‹ 5-18ã€‚å°† JavaScript å‡½æ•°å…¬å¼€ä¸º C å‡½æ•°ã€‚</div><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">int puts ( const char * str ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  print_string(str); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="æ‹·è´codeåˆ°å‰ªåˆ‡æ¿" class="copyButton_Ue-o clean-btn">å¤åˆ¶</button></div></div><p>ç»ˆäºï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è¿™æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚æˆ‘ä»¬çš„å‡½æ•°è°ƒç”¨<code>printf()</code> , printfåˆè°ƒç”¨<code>puts()</code>ï¼Œè€Œ<code>puts</code>è¢«å®šä¹‰ä¸ºè°ƒç”¨javascriptæä¾›çš„å‡½æ•°ã€‚å…³äºå°† C/C++ ä¸ WebAssembly ç»“åˆä½¿ç”¨ï¼Œè¿˜æœ‰æ›´å¤šéœ€è¦äº†è§£çš„å†…å®¹ï¼Œä½†è¿™æ˜¯åç»­ç« èŠ‚çš„ä¸»é¢˜ã€‚åœ¨é‚£ä¹‹å‰ï¼Œæ‚¨åˆšåˆšè·¨è¶Šäº†ä¸€ä¸ªé‡è¦çš„é¸¿æ²Ÿï¼Œäº†è§£ WebAssembly å¦‚ä½•åœ¨å¹•åå·¥ä½œã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å°†ç°æœ‰è½¯ä»¶ç§»æ¤åˆ°æµè§ˆå™¨ä¸­è¿è¡Œã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ ‡ç­¾</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/docs/tags/web-assembly">WebAssembly</a></li></ul></div></div><section></section></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/webassembly-the-definitive-guide/WebAssembly-Module"><div class="pagination-nav__sublabel">ä¸Šä¸€ç¯‡</div><div class="pagination-nav__label">Â« <!-- -->ç¬¬ä¸‰ç« ã€WebAssembly Module</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ä½¿ç”¨-c-å‡½æ•°" class="table-of-contents__link toc-highlight">ä½¿ç”¨ C å‡½æ•°</a></li><li><a href="#äº‹æƒ…å˜å¾—å¤æ‚" class="table-of-contents__link toc-highlight">äº‹æƒ…å˜å¾—å¤æ‚</a></li><li><a href="#cc-å’Œ-webassembly" class="table-of-contents__link toc-highlight">C/C++ å’Œ WebAssembly</a></li><li><a href="#æœ€å-webassembly-ä¸­çš„hello-world" class="table-of-contents__link toc-highlight">æœ€åï¼Œ WebAssembly ä¸­çš„â€œHello, world!â€</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.fa8e739b.js"></script>
<script src="/assets/js/main.82f7dc91.js"></script>
</body>
</html>
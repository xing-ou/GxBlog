<!doctype html>
<html lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Gx&#39;sBlog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Gx&#39;sBlog Atom Feed"><title data-react-helmet="true">如何用XcodeKit编写一个XcodeExtension? | Gx&#x27;sBlog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://gouxin.fun/2021/11/02/如何用XcodeKit编写一个XcodeExtension"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="如何用XcodeKit编写一个XcodeExtension? | Gx&#x27;sBlog"><meta data-react-helmet="true" name="description" content="HEADer"><meta data-react-helmet="true" property="og:description" content="HEADer"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-11-02T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="Xcode"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://gouxin.fun/2021/11/02/如何用XcodeKit编写一个XcodeExtension"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/2021/11/02/如何用XcodeKit编写一个XcodeExtension" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://gouxin.fun/2021/11/02/如何用XcodeKit编写一个XcodeExtension" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6149cb7c.css">
<link rel="preload" href="/assets/js/runtime~main.53ffc6d6.js" as="script">
<link rel="preload" href="/assets/js/main.90907b81.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/avator.jpg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">我的Blog</b></a><a class="navbar__item navbar__link" href="/">近期文章</a><a class="navbar__item navbar__link" href="/archive">日期归档</a><a class="navbar__item navbar__link" href="/tags">所有标签</a><a class="navbar__item navbar__link" href="/reading">书籍阅读</a><a class="navbar__item navbar__link" href="/aboutme">关于我</a></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">近期文章</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/13/SwiftUI专辑-071-一个定时器App">SwiftUI专辑070-一个定时器App</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/12/SwiftUI专辑-070-Combine简介">SwiftUI专辑070-Combine简介</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/11/SwiftUI专辑-069-@EnvironmentObject">SwiftUI专辑069-@EnvironmentObject</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/10/SwiftUI专辑-068-@StateObject">SwiftUI专辑068-@StateObject</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/09/SwiftUI专辑-067-@ObservedObject">SwiftUI专辑067-@ObservedObject</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/08/SwiftUI专辑-066-@Binding">SwiftUI专辑066-@Binding</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/07/SwiftUI专辑-065-@State">SwiftUI专辑065-@State</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/06/SwiftUI专辑-064-实现点赞动画">SwiftUI专辑064-创建一个card stack</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/05/SwiftUI专辑-063-实现点赞动画">SwiftUI专辑063-实现点赞动画</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/2022/01/04/SwiftUI专辑-062-创建一个弹性Header">SwiftUI专辑062-创建一个弹性Header</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_nmLu" itemprop="headline">如何用XcodeKit编写一个XcodeExtension?</h1><div class="blogPostData_3WzT margin-vert--md"><time datetime="2021-11-02T00:00:00.000Z" itemprop="datePublished">2021年11月2日</time> · <!-- -->预计阅读6分钟</div></header><div class="markdown" itemprop="articleBody"><p><img alt="HEADer" src="/assets/images/Header-4b8d90053fa6a3ff9c8fc57f0bc3b009.png">
Xcode提供了XcodeKit，来允许我们编写Xcode的扩展。但是这个Extension功能有限，只能处理当前打开的文件的源码。
我们可以用来：格式化、自动生成代码等。
常用的Extension有XCFormat，可以格式化Swift和OC代码，可以在AppStore中下载。
整体开发插件的功能还是比较简单，我们从头演示一个移除一行开头的数字的插件。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="创建xcode-extension工程">创建Xcode Extension工程<a class="hash-link" href="#创建xcode-extension工程" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="创建一个macos工程">创建一个macOS工程<a class="hash-link" href="#创建一个macos工程" title="Direct link to heading">​</a></h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww6clhtzij313a0do0u1.jpg" alt="image-20211129180100344"></p><p>这个macOS工程，对应从App Store下载完Extension后，在桌面上生成的那个App。你可以在这个App中做Extension设置相关的界面。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="新建一个xcode-source-editor-extention-target">新建一个Xcode Source Editor Extention Target<a class="hash-link" href="#新建一个xcode-source-editor-extention-target" title="Direct link to heading">​</a></h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww6l504ldj313y0cydh7.jpg" alt="截屏2021-11-29 下午6.09.11"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="运行extension-target">运行Extension Target<a class="hash-link" href="#运行extension-target" title="Direct link to heading">​</a></h3><p>点击运行Extension Target，选择Xcode，此时会打开一个灰色的Xcode。</p><p>打开我们的插件的macOS工程。</p><p>选择<code>Editor</code>菜单，底部就出现了我们的自定义菜单。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww6wlndiej30tq05ct95.jpg" alt="image-20211129182015367"></p><p>如果菜单没有出现，那么请修改一下Extension Target中XcodeKit的链接方式，选择<code>Embed &amp; Sign</code>。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww6xtzyhhj319u0k2gnk.jpg" alt="image-20211129182127182"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="xcode-source-editor-extention">Xcode Source Editor Extention<a class="hash-link" href="#xcode-source-editor-extention" title="Direct link to heading">​</a></h2><p>默认的<code>Xcode Source Editor Extention</code>会为你生成两个文件：</p><ul><li><code>SourceEditorExtension</code>:  这个文件定义你小菜单中的内容和extension启动时的回调。</li><li><code>SourceEditorCommand</code>: 是小菜单中的命令对应的实现类。</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="小菜单的定义">小菜单的定义<a class="hash-link" href="#小菜单的定义" title="Direct link to heading">​</a></h3><p>小菜单的定义有两种方式，一种是通过<code>SourceEditorExtension</code>的代码定义。一种是通过<code>Info.plist</code>定义。代码定义的优先级更高，会覆盖Info.plist中的定义。</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="在infoplist中定义">在Info.plist中定义<a class="hash-link" href="#在infoplist中定义" title="Direct link to heading">​</a></h4><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww78nx1j2j318i0ceq5g.jpg" alt="image-20211129183151859"></p><p>每个命令就是小菜单中的一个命令对应。</p><ul><li>XCSourceEditorCommandClassName： 这个命令对应的实现类。格式是moduleName + 实现类的类名： <code>$(PRODUCT_MODULE_NAME).YourImplClassName</code>。</li><li>XCSourceEditorCommandIdentifier：你的这个命令的一个唯一id。格式是bundleId +一个字符串： <code>$(PRODUCT_BUNDLE_IDENTIFIER).SourceEditorCommand</code></li><li>XCSourceEditorCommandName：菜单中出现的命令的名字</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="在sourceeditorextension中定义小菜单">在SourceEditorExtension中定义小菜单<a class="hash-link" href="#在sourceeditorextension中定义小菜单" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_K1bP language-swift theme-code-block"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class SourceEditorExtension: NSObject, XCSourceEditorExtension {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func extensionDidFinishLaunching() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // If your extension needs to do any work at launch, implement this optional method.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var commandDefinitions: [[XCSourceEditorCommandDefinitionKey: Any]] {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // If your extension needs to return a collection of command definitions that differs from those in its Info.plist, implement this optional property getter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let command: [XCSourceEditorCommandDefinitionKey: Any] = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //格式moduleName.命令实现类的类名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .classNameKey: &quot;GxEditorToolsExtension.SourceEditorCommand&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //格式bundleId.自定义字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .identifierKey: &quot;com.haixue.GxXcodeEditorTools.GxEditorToolsExtension.removeLinePrefixNum&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            //自定义名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .nameKey: &quot;我的小菜单&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return [command]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gww7hohzb6j30ok05gaag.jpg" alt="image-20211129184031347"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="命令的实现">命令的实现<a class="hash-link" href="#命令的实现" title="Direct link to heading">​</a></h3><p>实现类都遵循<code>XCSourceEditorCommand</code>协议。</p><p>当我们点击小菜单，会通过command的<code>XCSourceEditorCommandClassName</code>找到对应的实现类。调用实现类的<code>func perform(...)</code>方法。</p><p>我们看到新建项目默认为我们生成了一个command模板SourceEditorCommand。</p><div class="codeBlockContainer_K1bP language-swift theme-code-block"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">class SourceEditorCommand: NSObject, XCSourceEditorCommand {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func perform(with invocation: XCSourceEditorCommandInvocation, completionHandler: @escaping (Error?) -&gt; Void ) -&gt; Void {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Implement your command here, invoking the completion handler when done. Pass it nil on success, and an NSError on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        completionHandler(nil)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="实现我们自己的命令">实现我们自己的命令<a class="hash-link" href="#实现我们自己的命令" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP language-swift theme-code-block"><div class="codeBlockContent_hGly swift"><pre tabindex="0" class="prism-code language-swift codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">import Foundation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import XcodeKit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class RemoveLinePrefixNumCommand: NSObject, XCSourceEditorCommand {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func perform(with invocation: XCSourceEditorCommandInvocation, completionHandler: @escaping (Error?) -&gt; Void ) -&gt; Void {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Implement your command here, invoking the completion handler when done. Pass it nil on success, and an NSError on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let lines = invocation.buffer.lines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let result = lines.map { &quot;\($0)&quot; }.map{ self.removePrefixNum(str: $0) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        invocation.buffer.lines.removeAllObjects()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        invocation.buffer.lines.addObjects(from: result)        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        completionHandler(nil)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func removePrefixNum(str: String) -&gt; String {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var chars: [Character] = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        //空格和数字</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        let sets: Set&lt;Character&gt; = [&quot; &quot;, &quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var shouldCheck = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for c in str {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if shouldCheck {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if sets.contains(c) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    chars.append(&quot; &quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    chars.append(c)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    shouldCheck = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } else{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                chars.append(c)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return String(chars)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><div class="codeBlockContainer_K1bP language-objective-c theme-code-block"><div class="codeBlockContent_hGly objective-c"><pre tabindex="0" class="prism-code language-objective-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">//可以看到invocation有用的也只有一个Buffer对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@interface XCSourceEditorCommandInvocation : NSObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/** The identifier of the command the user invoked. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly, copy) NSString *commandIdentifier;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/** The buffer of source text on which the command can operate. */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly, strong) XCSourceTextBuffer *buffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (copy) void (^cancellationHandler)(void);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@end</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><div class="codeBlockContainer_K1bP language-objective-c theme-code-block"><div class="codeBlockContent_hGly objective-c"><pre tabindex="0" class="prism-code language-objective-c codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">///buffer，又只能操作tab、lines、selections。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@interface XCSourceTextBuffer : NSObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly, copy) NSString *contentUTI;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly) NSInteger tabWidth;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly) NSInteger indentationWidth;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly) BOOL usesTabsForIndentation;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly, strong) NSMutableArray &lt;NSString *&gt; *lines;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (readonly, strong) NSMutableArray &lt;XCSourceTextRange *&gt; *selections;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@property (copy) NSString *completeBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@end</span><br></span></code></pre><button type="button" aria-label="拷贝code到剪切板" class="copyButton_Ue-o clean-btn">复制</button></div></div><p>xcodeKit只能操作文本，像语法解析等都得借助别的工具来实现。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="调试">调试<a class="hash-link" href="#调试" title="Direct link to heading">​</a></h3><p>在工程中打上断点，点击运行。</p><p>在灰色xcode中打开我们工程，点击小菜单。就会进入我们断点。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="集成到xcode的editor菜单">集成到Xcode的Editor菜单<a class="hash-link" href="#集成到xcode的editor菜单" title="Direct link to heading">​</a></h3><p>进入<strong>系统偏好设置</strong>--<strong>扩展</strong>，选中我们的插件钩上即可</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gwwg9umm74j30xw0oc0uo.jpg" alt="image-20211129234423601"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="制作安装包">制作安装包<a class="hash-link" href="#制作安装包" title="Direct link to heading">​</a></h3><p><code>archive</code> ，然后选择copy app，得到一个.app</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwwghg4w4tj311q0lydgo.jpg" alt="image-20211129235140936"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwwgj43el5j30t20jsac5.jpg" alt="image-20211129235317200"></p><p>新建一个文件夹，将.app和应用程序的提升文件一起放入，重命名提升文件为Application。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwwgkqyjeaj30f405s3yh.jpg" alt="image-20211129235452152"></p><p>打开磁盘工具</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwwglezhl6j30li0ti75q.jpg" alt="image-20211129235529816"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gwwglrcau8j30v4084ab6.jpg" alt="image-20211129235549564"></p><p>选择刚刚的文件夹，就制作成了dmg。</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3bEF"><div class="col"><b>标签</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/xcode">Xcode</a></li></ul></div><section></section></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/2021/11/03/一个简单的StringKeyChain"><div class="pagination-nav__sublabel">上一篇</div><div class="pagination-nav__label">« <!-- -->一个简单的StringKeyChain</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/2021/11/01/如何查看ios和ipados当前系统版本占比"><div class="pagination-nav__sublabel">下一篇</div><div class="pagination-nav__label">如何查看iOS、iPadOS系统版本占比？<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#创建xcode-extension工程" class="table-of-contents__link toc-highlight">创建Xcode Extension工程</a><ul><li><a href="#创建一个macos工程" class="table-of-contents__link toc-highlight">创建一个macOS工程</a></li><li><a href="#新建一个xcode-source-editor-extention-target" class="table-of-contents__link toc-highlight">新建一个Xcode Source Editor Extention Target</a></li><li><a href="#运行extension-target" class="table-of-contents__link toc-highlight">运行Extension Target</a></li></ul></li><li><a href="#xcode-source-editor-extention" class="table-of-contents__link toc-highlight">Xcode Source Editor Extention</a><ul><li><a href="#小菜单的定义" class="table-of-contents__link toc-highlight">小菜单的定义</a></li><li><a href="#命令的实现" class="table-of-contents__link toc-highlight">命令的实现</a></li><li><a href="#实现我们自己的命令" class="table-of-contents__link toc-highlight">实现我们自己的命令</a></li><li><a href="#调试" class="table-of-contents__link toc-highlight">调试</a></li><li><a href="#集成到xcode的editor菜单" class="table-of-contents__link toc-highlight">集成到Xcode的Editor菜单</a></li><li><a href="#制作安装包" class="table-of-contents__link toc-highlight">制作安装包</a></li></ul></li></ul></div></div></div></div></div></div>
<script src="/assets/js/runtime~main.53ffc6d6.js"></script>
<script src="/assets/js/main.90907b81.js"></script>
</body>
</html>